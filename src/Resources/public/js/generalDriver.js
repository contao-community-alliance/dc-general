var BackendGeneral={loadSubTree:function(e,t){e.blur();var l=t.toggler,n=t.level,s=t.mode,a=$(l),i=$(e).getFirst("img");return t.action="DcGeneralLoadSubTree",t.REQUEST_TOKEN=Contao.request_token,a?("none"==a.getStyle("display")?(a.setStyle("display","inline"),i.src=i.src.replace("folPlus.svg","folMinus.svg"),$(e).store("tip:title",Contao.lang.collapse),new Request.Contao({url:t.url,field:e}).post(t)):(a.setStyle("display","none"),i.src=i.src.replace("folMinus.svg","folPlus.svg"),$(e).store("tip:title",Contao.lang.expand),new Request.Contao({url:t.url,field:e}).post(t)),!1):(new Request.Contao({url:t.url,field:e,evalScripts:!0,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" â€¦"),onSuccess:function(t,a){var r=new Element("li",{id:l,class:"parent",styles:{display:"inline"}});new Element("ul",{class:"level_"+n,html:t}).inject(r,"bottom");if(5==s)r.inject($(e).getParent("li"),"after");else{var o=$(e).getParent("li");r.inject(o,"after")}r.getElements("a").each((function(e){e.href=e.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)})),$(e).store("tip:title",Contao.lang.collapse),i.src=i.src.replace("folPlus.svg","folMinus.svg"),window.fireEvent("structure"),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post(t),!1)},toggleVisibility:function(e,t,l){e.blur(),t||(t="visible.svg"),l||(l="invisible.svg");const n="dark"===document.documentElement.dataset.colorScheme?"--dark":"",s=e.getElementsByTagName("img"),a=s.length>1?s[0]:null,i=s[s.length-1],r=e=>{let t=e.lastIndexOf(".");return e.slice(0,t)+n+"."+e.slice(t+1)},o=t,c=a?r(t):null,g=l,d=a?r(l):null;let u,m,p=null,f=-1!==i.src.indexOf(g),v=e.getParent("div");return console.log("Last image:"+i.src+" | publish: "+f),new Request.Contao({url:$(e).href,followRedirects:!1,onSuccess:function(){var t;(v.hasClass("tl_right")?p=v.getPrevious("div").getElement("img"):v.hasClass("tl_listing_container")?(p=e.getParent("td").getPrevious("td").getFirst("div.list_icon"),null==p&&(p=e.getParent("td").getPrevious("td").getElement("div.cte_type")),null==p&&(p=e.getParent("tr").getFirst("td").getElement("div.list_icon_new"))):(u=v.getNext("div"))&&u.hasClass("cte_type")&&(p=u),null===p&&(m=e.getParent().getParent().getElements("div.list_icon").getFirst().getParent())&&(p=m[0]),null!=p)&&("img"===p.nodeName.toLowerCase()?p.getParent("ul.tl_listing").hasClass("tl_tree_xtnd")?p.src=f?p.src.replace(/_1\.(gif|png|jpe?g)/,".$1"):p.src.replace(/\.(gif|png|jpe?g)/,"_1.$1"):(p.src.match(/folPlus|folMinus/)&&(p=p.getParent("a").getNext("a")?p.getParent("a").getNext("a").getFirst("img"):new Element("img")),f?(t=p.src.replace(/.*_([0-9])\.(gif|png|jpe?g)/,"$1"),p.src=p.src.replace(/_[0-9]\.(gif|png|jpe?g)/,(1===t.toInt()?"":"_"+(t.toInt()-1))+".$1")):(t=p.src.replace(/.*_([0-9])\.(gif|png|jpe?g)/,"$1"),p.src=p.src.replace(/(_[0-9])?\.(gif|png|jpe?g)/,(t===p.src?"_1":"_"+(t.toInt()+1))+".$2"))):p.hasClass("cte_type")?f?(p.addClass("published"),p.removeClass("unpublished")):(p.addClass("unpublished"),p.removeClass("published")):f?p.setStyle("background-image",p.getStyle("background-image").replace(/_\.(gif|png|jpe?g)/,".$1")):p.setStyle("background-image",p.getStyle("background-image").replace(/\.(gif|png|jpe?g)/,"_.$1")));f?(i.src=i.src.replace(g,o),a&&(a.src=a.src.replace(d,c))):(i.src=i.src.replace(o,g),a&&(a.src=a.src.replace(c,d)))}}).get({state:f?1:0}),!1},setLegendState:function(e,t,l){e.blur();var n=$("pal_"+t);return n.hasClass("collapsed")?(n.removeClass("collapsed"),(new Request.Contao).post({action:"setLegendState",legend:t,table:l,state:1,REQUEST_TOKEN:Contao.request_token})):(n.addClass("collapsed"),(new Request.Contao).post({action:"setLegendState",legend:t,table:l,state:0,REQUEST_TOKEN:Contao.request_token})),!1},displayMessage:function(e,t,l){var n=$("general_messageBox"),s=$("general_messageOverlay"),a=window.getScroll();null===s&&(s=new Element("div",{id:"general_messageOverlay"}).inject($(document.body),"bottom")),s.set({styles:{display:"block",top:a.y+"px"}}),null===n&&(n=new Element("div",{id:"general_messageBox"}).inject($(document.body),"bottom")),n.set({html:e,styles:{display:"block",top:a.y+100+"px"}}),l&&n.addClass(l),t&&n.addClass("loading")},hideMessage:function(){var e=$("general_messageBox"),t=$("general_messageOverlay");t&&t.setStyle("display","none"),e&&e.setStyle("display","none"),t.remove(),e.remove()},confirmSelectOverrideEditAll:function(e,t,l){e.blur();var n=e.form.elements[t],s=!1;return $$(n).each((function(e){if(s||!e.checked)return!0;s=!0})),s?("delete"===e.name||(e.onclick="",e.click()),!0):(this.displayMessage(l,!1,"box-small"),!1)},confirmSelectDeleteAll:function(e,t,l,n,s,a){return e.blur(),!!this.confirmSelectOverrideEditAll(e,t,l)&&(this.confirmDelete(e,n,s,a),!0)},confirmDelete:function(e,t,l,n){var s=new Element("div"),a=(new Element("h2",{html:t,class:"tl_info"}).inject(s,"bottom"),new Element("p").inject(s,"bottom"),new Element("div",{class:"tl_submit_container"}).inject(s,"bottom")),i=new Element("input",{id:e.name+"Ok",name:e.name+"Ok",value:l,type:"submit",class:"tl_submit"}).inject(a,"bottom"),r=new Element("input",{id:e.name+"Abort",name:e.name+"Abort",value:n,type:"submit",class:"tl_submit"}).inject(a,"bottom");return this.displayMessage(s.get("html"),!1,"box-small"),$(i.id).addEvent("click",(function(){e.onclick="",e.click()})),$(r.id).addEvent("click",(function(){BackendGeneral.hideMessage()})),!0}};
//# sourceMappingURL=generalDriver.js.map
